<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OT CRM App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  </head>
  <body>
    <div class="app-container">
      <!-- Left sidebar with customer list -->
      <button class="hamburger-menu" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>
  
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <div class="logo-container">
          <h1>OT <span class="highlight">CRM</span></h1>
          <a href="/logout">Logout</a>
        </div>
        
        <!-- Search Customers -->
        <div class="search-container">
          <input type="text" id="customerSearch" placeholder="Search customers..." />
        </div>
        
        <!-- Customers List -->
        <div class="customers-list" id="customersList">
          <div class="customer-list-content">
            {% for customer in customers %}
            <div class="customer-item" 
                 data-id="{{ customer[0] }}" 
                 data-name="{{ customer[1] }}" 
                 onclick="fetchCustomerDetails({{ customer[0] }})">
                <h3>{{ customer[1] }}</h3>
            </div>
            {% endfor %}
          </div>
        </div>
      </aside>

      <!-- Main content area -->
      <main class="main-content">
        <!-- Top navigation bar -->
        <nav class="top-navbar">
          <div class="company-info">
            <h1 id="companyName"><a href="/index">{{company_name}}</a></h1>
            <p id="companySlogan">{{company_slogan}}</p>

          </div>
          <div class="date-display" id="currentDate"></div>
        </nav>


        <div id="defaultView" class="content-section active">
          <div class="actions-header">
            <h2>Open Action Items</h2>
            <div class="action-buttons">
              <button  id="addCustomerBtn" class="btn primary">Add Customer</button>
              <button  id="contactsListBtn" class="btn secondary">Contacts List</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table" id="actionsTable">
              <thead>
                <tr>
                  <th><input type="text" id="filter-customer" placeholder="Customer..." class="filter-input" /></th>
                  <th>Item</th>
                  <th><input type="text" id="filter-responsible" placeholder="Responsible..." class="filter-input" /></th>
                  <th>
                    Due Date
                    <button onclick="sortDueDate()" class="sort-btn"><img class="sortimg" src="static/img/sorting.png" alt="Sort"></button>
                  </th>
                  <th>
                    <select id="filter-status" class="filter-input">
                      <option value="">Status</option>
                      <option value="Not Started">Not Started</option>
                      <option value="In Progress">In Progress</option>
                      <option value="Pending">Pending</option>
                      <option value="Completed">Completed</option>
    
                    </select>
                  </th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="action-items-table">
                {% if action_items|length == 0 %}
                  <tr>
                    <td colspan="6" class="no-action-items-message">No open action items.</td>
                  </tr>
                {% else %}
                  {% for action_item in action_items %}
                    {% if action_item[5] != "Completed" %}
                      {% set due_date = action_item[4] | string %}
                      {% set current_date = current_time.strftime('%Y-%m-%d') %}
                      {% set is_overdue = due_date < current_date %}
            
                      <tr class="action-item-row {% if is_overdue %}overdue{% endif %}">
                        <td>{{ action_item[1] }}</td>
                        <td>{{ action_item[2] }}</td>
                        <td>{{ action_item[3] }}</td>
                        <td>{{ action_item[4] }}</td>
                        <td>
                            <span class="status 
                            {% if action_item[5] == 'Pending' %}pending
                            {% elif action_item[5] == 'In Progress' %}in-progress
                            {% elif action_item[5] == 'Not Started' %}not-started
                            {% elif action_item[5] == 'Completed' %}completed
                            {% endif %}
                            {% if is_overdue %} overdue-status{% endif %}
                            ">{{ action_item[5] }}</span>
                        </td>
                        <td>
                          <form method="GET" class="go-to-action-item-form">
                            <input type="hidden" name="customer_name" value="{{ action_item[1] }}">
                            <input type="hidden" name="category_id" value="{{ action_item[7] }}"> 
                            <input type="hidden" name="item_category" value="{{ action_item[6] }}">
                            <!-- <button type="submit" class="go-to-action-item-btn" title="Go to this action item">
                              <span class="arrow">â†’</span>
                            </button> -->
                          </form>
                        </td>
                      </tr>
                    {% endif %}
                  {% endfor %}
                {% endif %}
            </tbody>
            </table>
          </div>
        </div>

        <div id="contactsView" class="content-section" style="display: none;">
          <div class="actions-header">
            <h2>Contacts List</h2>
            <div class="search-contact-container">
              <input type="text" id="contactsSearch" placeholder="Search contact..." />
            </div>
            <button id="backToMainView" class="btn secondary">Back</button>
          </div>
          <div id="contactCardsContainer" class="contacts-grid"></div>
        </div>



        <div id="customerView" class="content-section">

          <nav class="customer-navbar">
            <ul>
              <li data-section="companyInfo" class="active">Company Information</li>
              <li data-section="contactPersons">Contact Persons</li>
              <li data-section="customerOrders">Orders</li>
              <li data-section="customerMeetings">Meetings</li>
              <li data-section="customerUpdates">Updates</li>
            </ul>
         
          </nav>

          <div id="customerSections" class="customer-sections">

            <div id="companyInfo" class="customer-section active">
              <div class="section-header">
                <h2>Company Information</h2>
                <div style="display:flex; gap:5px;">
                  <button class="btn primary edit-btn">Edit</button>

                  <form action="{{ url_for('delete_customer') }}" method="POST" onsubmit="return confirmDelete(event)" >
                    <input type="hidden" name="customer_id" id="customerIdInput">
                    <button id="deleteCustomerBtn" type="submit" class="btn danger">Delete Customer</button>
                  </form> 
                </div>
              </div>
              <div class="section-content view-mode">
                <div class="info-group">
                  <label>Company Name:</label>
                  <span class="info-value" data-field="companyName"></span>
                </div>
                <div class="info-group">
                  <label>Country:</label>
                  <span class="info-value" data-field="country"></span>
                </div>
                <div class="info-group">
                  <label>Address:</label>
                  <span class="info-value" data-field="address"></span>
                </div>
                <div class="info-group">
                  <label>Status:</label>
                  <span class="info-value" data-field="status"></span>
                </div>
                <div class="info-group">
                  <label>Start Date:</label>
                  <span class="info-value" data-field="startDate"></span>
                </div>
                <div class="info-group">
                  <label>NDA File:</label>
                  <span class="info-value" data-field="ndaFile"></span>
                </div>
                <div class="info-group">
                  <label>Line:</label>
                  <span class="info-value" data-field="line"></span>
                </div>
                <div class="info-group">
                  <label>Line Speed (m/min):</label>
                  <span class="info-value" data-field="lineSpeed"></span>
                </div>
                <div class="info-group">
                  <label>Line Width (mm):</label>
                  <span class="info-value" data-field="lineWidth"></span>
                </div>
                <div class="info-group">
                  <label>Application:</label>
                  <span class="info-value" data-field="application"></span>
                </div>
                <div class="info-group">
                  <label>Curing Status:</label>
                  <span class="info-value" data-field="curingStatus"></span>
                </div>
                <div class="info-group">
                  <label>Targets:</label>
                  <span class="info-value" data-field="targets"></span>
                </div>
                <div class="info-group">
                  <label>Amount of Potential Lines:</label>
                  <span class="info-value" data-field="linesAmount"></span>
                </div>
                <div class="info-group">
                  <label>Annual Volume (kg):</label>
                  <span class="info-value" data-field="annualVolume"></span>
                </div>
              </div>
          
              <div class="section-content edit-mode">
                <form id="updateCustomerDetails" action="/update_customer_details" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="customer_id" id="customerIdInput">
                <div class="info-group">
                  <label for="companyName">Company Name:</label>
                  <input type="text" id="companyName" name="companyName" class="info-value" data-field="companyName"/>
                </div>
                <div class="info-group">
                  <label for="country">Country:</label>
                  <input type="text" id="country" name="country" class="info-value" data-field="country"/>
                </div>
                <div class="info-group">
                  <label for="address">Address:</label>
                  <textarea id="address" name="address" class="info-value" data-field="address"></textarea>
                </div>
                <div class="info-group">
                    <label for="status">Status:</label>
                    <select id="status" name="status" required>
                        <option value="Customer">Customer</option>
                        <option value="POC">POC</option>
                        <option value="Inital Contact">Initial Contact</option>
                        <option value="On hold">On Hold</option>
                        <option value="Not interested">Not Interested</option>
                    </select>
                </div>
                <div class="info-group">
                  <label for="startDate">Start Date:</label>
                  <input type="date" id="startDate" name="startDate" class="info-value" data-field="startDate"/>
                </div>
                <div class="info-group">
                  <label for="ndaFile">NDA File:</label>
                  <input type="file" id="ndaFile" name="ndaFile" class="info-value" data-field="ndaFile"/>
                </div>
                <div class="info-group">
                  <label for="line">Line:</label>
                  <input type="text" id="line" name="line" class="info-value" data-field="line"/>
                </div>
                <div class="info-group">
                  <label for="lineSpeed">Line Speed (m/min):</label>
                  <input type="number" id="lineSpeed" name="lineSpeed" class="info-value" data-field="lineSpeed"/>
                </div>
                <div class="info-group">
                  <label for="lineWidth">Line Width (mm):</label>
                  <input type="number" id="lineWidth" name="lineWidth" class="info-value" data-field="lineWidth"/>
                </div>
                <div class="info-group">
                  <label for="application">Application:</label>
                  <input type="text" id="application" name="application" class="info-value" data-field="application"/>
                </div>
                <div class="info-group">
                  <label for="curingStatus">Curing Status:</label>
                  <input type="text" id="curingStatus" name="curingStatus" class="info-value" data-field="curingStatus"/>
                </div>
                <div class="info-group">
                  <label for="targets">Targets:</label>
                  <input type="text" id="targets" name="targets" class="info-value" data-field="targets"/>
                </div>
                <div class="info-group">
                  <label for="linesAmount">Amount of Potential Lines:</label>
                  <input type="number" id="linesAmount" name="linesAmount" class="info-value" data-field="linesAmount"/>
                </div>
                <div class="info-group">
                  <label for="annualVolume">Annual Volume (kg):</label>
                  <input type="number" id="annualVolume" name="annualVolume" class="info-value" data-field="annualVolume"/>
                </div>
          
                <div class="button-group">
                  <button class="btn primary save-btn">Save</button>
                  <button class="btn secondary cancel-btn">Cancel</button>
                </div>
              </form>

              </div>
            </div>
          
          </div>

            <div id="contactPersons" class="customer-section">
              <div class="section-header">
                <h2>Contact Persons</h2>
                <button id="addContactBtn" class="btn primary add-contact-btn">Add Contact</button>
              </div>
              <div class="contact-cards-container">
                <!-- Contacts will be populated here -->
              </div>
            </div>

            <div id="customerOrders" class="customer-section">
              <div class="section-header">
                <h2>Customer Orders</h2>
                <button id="addOrderBtn" class="btn primary add-order-btn">Add Order</button>
              </div>
              <div class="table-container">
                <table class="data-table" id="ordersTable">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Order No</th>
                      <th>Material</th>
                      <th>Amount</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Orders will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>

            <div id="customerMeetings" class="customer-section">
              <div class="section-header">
                <h2>Customer Meetings</h2>
                <button id="addMeetingBtn" class="btn primary add-meeting-btn">Add Meeting</button>
              </div>
              <div class="table-container">
                <table class="data-table" id="meetingsTable">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Title</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Meetings will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Customer Updates Section -->
            <div id="customerUpdates" class="customer-section">
              <div class="section-header">
                <h2>Customer Updates</h2>
                <button id="addUpdateBtn" class="btn primary add-update-btn">Add Update</button>
              </div>
              <div class="table-container">
                <table class="data-table" id="updatesTable">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Title</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Updates will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>

          </div>
      </main>
    </div>

        <!-- Modals -->
        <div id="addCustomerModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Add New Customer</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
              <h3>Company Information</h3>
              <form id="addCustomerForm" action="/add_customer" enctype="multipart/form-data" method="POST">
                <!-- Basic Information -->
                  <div class="info-grid">
                    <div class="form-group">
                      <label for="name">Name:</label>
                      <input type="text" id="name" name="name" required />
                    </div>
                    <div class="form-group">
                      <label for="country">Country:</label>
                      <input type="text" id="country" name="country" required />
                    </div>
                    <div class="form-group">
                      <label for="address">Address:</label>
                      <textarea id="address" name="address"></textarea>
                    </div>
                    <div class="form-group">
                      <label for="status">Status:</label>
                      <select id="status" name="status" required>
                        <option value="Customer">Customer</option>
                        <option value="POC">POC</option>
                        <option value="Initial Contact">Initial Contact</option>
                        <option value="On Hold">On Hold</option>
                        <option value="Not Interested">Not Interested</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="lead">Lead:</label>
                      <select id="lead" name="lead" required>
                        <option value="kafrit">Kafrit</option>
                        <option value="n3cure">N3Cure</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="sales_rep">Sales Rep:</label>
                      <select id="sales_rep" name="sales_rep" required>
                        <option value="Roee Levy">Roee Levy</option>
                        <option value="Liat Heled Habshush">Liat Heled Habshush</option>
                        <option value="Yoram Ben-ari">Yoram Ben-ari</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="start_date">Start Date:</label>
                      <input type="date" id="start_date" name="start_date" />
                    </div>
                    <div class="form-group">
                      <label for="nda_file">Attach NDA File:</label>
                      <input type="file" name="nda_file" id="nda_file" accept=".pdf,.doc,.docx,.xls,.xlsx" />
                    </div>
                  </div>
                    <h3>Technical Data</h3>
                  <div class="info-grid">
                    <div class="form-group">
                      <label for="line">Line:</label>
                      <input type="text" id="line" name="line" />
                    </div>
                    <div class="form-group">
                      <label for="application">Application:</label>
                      <input type="text" id="application" name="application" />
                    </div>
                    <div class="form-group">
                      <label for="line_speed">Line Speed (m/min):</label>
                      <input type="number" id="line_speed" name="line_speed" />
                    </div>
                    <div class="form-group">
                      <label for="line_width">Line Width (mm):</label>
                      <input type="number" id="line_width" name="line_width" />
                    </div>
                    <div class="form-group">
                      <label for="curing">Curing:</label>
                      <input type="text" id="curing" name="curing" />
                    </div>
                    <div class="form-group">
                      <label for="targets">Targets:</label>
                      <input type="text" id="targets" name="targets" />
                    </div>
                  </div>
        
                <!-- Commercial Data -->
                  <h3>Commercial Details</h3>
                  <div class="info-grid">
                    <div class="form-group">
                      <label for="annual_volume">Annual Volume (kg):</label>
                      <input type="number" id="annual_volume" name="annual_volume" />
                    </div>
                    <div class="form-group">
                      <label for="potential_lines">Amount of Potential Lines:</label>
                      <input type="number" id="potential_lines" name="potential_lines" />
                    </div>
                  </div>        
                <!-- Buttons -->
                <div class="button-group">
                  <button type="submit" class="btn primary">Add Customer</button>
                  <button type="button" class="btn secondary cancel-modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div id="addContactModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Add New Contact</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addContactForm" action="{{ url_for('add_contact') }}" enctype="multipart/form-data" method="POST">
                <!-- Basic Information -->
                <input type="hidden" name="customer_id" id="customerIdInput">
                <div class="info-grid">
                  <div  class="form-group">
                      <label for="contact_name">Contact Name:</label>
                      <input type="text" id="contact_name" name="contact_name" required>
                  </div>
                  <div  class="form-group">
                      <label for="contact_email">Email:</label>
                      <input type="email" id="contact_email" name="contact_email">
                  </div>
                  <div  class="form-group">
                      <label for="contact_phone">Phone:</label>
                      <input type="text" id="contact_phone" name="contact_phone">
                  </div>
                  <div  class="form-group">
                      <label for="contact_role">Role:</label>
                      <input type="text" id="contact_role" name="contact_role" required>
                  </div>
              </div>

                <!-- Buttons -->
                <div class="button-group">
                  <button type="submit" class="btn primary">Add Contact</button>
                  <button type="button" class="btn secondary cancel-modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div id="addOrderModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Add New Order</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addOrderForm" action="{{ url_for('add_order') }}" enctype="multipart/form-data" method="POST">
                <!-- Basic Information -->
                <input type="hidden" name="customer_id" id="customerIdInput">
                <div class="info-grid">
                  <div  class="form-group">
                    <label for="material">Material:</label>
                    <input type="text" id="material" name="material" required>
                  </div>
                  <div  class="form-group">
                    <label for="order_no">Order No.:</label>
                    <input type="text" id="order_no" name="order_no" required>
                  </div>
                  <div  class="form-group">
                    <label for="amount">Amount (kg):</label>
                    <input type="number" id="amount" name="amount" required>
                  </div>
                  <div  class="form-group">
                    <label for="goal">Goal:</label>
                    <input type="text" id="goal" name="goal">
                  </div>
                  <div  class="form-group">
                    <label for="notes">Notes:</label>
                    <textarea id="notes" name="notes" rows="4"></textarea>
                  </div>
                  <div  class="form-group">
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                  </div>
                  <div  class="form-group">
                    <label for="order_file">Order File:</label>
                    <input type="file" id="order_file" name="order_file" accept=".pdf,.doc,.docx,.xls,.xlsx">
                  </div>
                  <div  class="form-group">
                    <label for="invoice_file">Invoice File:</label>
                    <input type="file" id="invoice_file" name="invoice_file" accept=".pdf,.doc,.docx,.xls,.xlsx">
                  </div>
              </div>

                <!-- Buttons -->
                <div class="button-group">
                  <button type="submit" class="btn primary">Submit Order</button>
                  <button type="button" class="btn secondary cancel-modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div id="viewOrderModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Order Details</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
              <div class="info-grid">
                <div class="form-group">
                  <p><strong>Material:</strong> <span id="viewOrderMaterial"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Date:</strong> <span id="viewOrderDate"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Order No:</strong> <span id="viewOrderNo"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Amount:</strong> <span id="viewOrderAmount"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Goal:</strong> <span id="viewOrderGoal"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Notes:</strong> <span id="viewOrderNotes"></span></p>
                </div>

                <div class="form-group">
                  <p><strong>Order File: </strong><a id="viewOrderFileLink" target="_blank">Download</a></p>
                </div>
                <div class="form-group">
                  <p><strong>Invoice File: </strong><a id="viewinvoiceFileLink" target="_blank">Download</a></p> 
                </div>
              </div>
            </div>
          </div>
        </div>




        <div id="addMeetingModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Add New Meeting</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addMeetingForm" action="{{ url_for('add_meeting') }}" enctype="multipart/form-data" method="POST">
                <!-- Basic Information -->
                <input type="hidden" name="customer_id" id="customerIdInput">
                <div class="info-grid">
                  <div  class="form-group">
                    <label for="title">Title:</label>
                    <input type="text" id="meeting-title" name="title" required>
                  </div>
                  <div  class="form-group">
                    <label for="attendees">Attendees:</label>
                    <input type="text" id="meeting-attendees" name="attendees" placeholder="Comma-separated names" required>
                  </div>
                  <div  class="form-group">
                    <label for="date">Date:</label>
                    <input type="date" id="meeting-date" name="date" required>
                  </div>
                </div>

                  <div  class="form-group">
                    <label for="summary">Summary:</label>
                    <textarea id="meeting-summary" name="summary" required></textarea>
                  </div>
              <div style="display:flex; justify-content:space-between;">
                <h3>Action Items</h3>
                <button type="button" class="btn secondary add-action-item">Add Action Item</button>
              </div>
              <div id="action-items-container" class="action-items-container"></div>
      
                <!-- Buttons -->
                <div class="button-group">
                  <button type="submit" class="btn primary">Submit Order</button>
                  <button type="button" class="btn secondary cancel-modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div id="viewMeetingModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Meeting Details</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
              <div class="info-grid">
                <div class="form-group">
                  <p><strong>Title:</strong> <span id="viewMeetingTitle"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Attendees:</strong> <span id="viewMeetingAttendees"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Date:</strong> <span id="viewMeetingDate"></span></p>
                </div>
              </div>

                <div class="form-group">
                  <p><strong>Summary:</strong><textarea id="viewMeetingSummary" readonly></textarea>
                  </p>
                </div>
                <div class="form-group">
                  <p><strong>Action Items:</strong></p>
                  <ul id="viewMeetingActions"></ul>  <!-- Action items list -->
                </div>
            </div>
          </div>
        </div>


        <div id="addUpdateModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Add New Update</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addUpdateForm" action="{{ url_for('add_update') }}" enctype="multipart/form-data" method="POST">
                <!-- Basic Information -->
                <input type="hidden" name="customer_id" id="customerIdInput">
                <div class="info-grid">
                  <div  class="form-group">
                    <label for="title">Title</label>
                    <input id="title" name="title" rows="4" required>
                  </div>
                  <div  class="form-group">
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                  </div>
                </div>

                  <div  class="form-group">
                    <label for="update">Update:</label>
                    <textarea id="update" name="update" rows="4" required></textarea>
                  </div>

                  <div  class="form-group">
                    <label for="next_step">Next Step:</label>
                    <input type="text" id="next_step" name="next_step">
                  </div>
                  <div  class="form-group">
                    <label for="file">Attach File:</label>
                    <input type="file" id="file" name="file" accept=".pdf,.doc,.docx,.xls,.xlsx">
                  </div>
              <div class="add-action-style" ">
                <h3>Action Items</h3>
                <button type="button" class="btn secondary add-action-item">Add Action Item</button>
              </div>
              <div id="action-items-container" class="action-items-container"></div>
                <!-- Buttons -->
                <div class="button-group">
                  <button type="submit" class="btn primary">Submit Order</button>
                  <button type="button" class="btn secondary cancel-modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div id="viewUpdateModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Update Details</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
              <div class="info-grid">
                <div class="form-group">
                  <p><strong>Title:</strong> <span id="viewUpdateTitle"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Date:</strong> <span id="viewUpdateDate"></span></p>
                </div>
              </div>
              <div class="form-group">
                <p><strong>Update:</strong> <textarea id="viewUpdateUpdate" readonly></textarea></p>
              </div>
                <div class="form-group">
                  <p><strong>Next Step:</strong> <span id="viewUpdateNextStep"></span></p>
                </div>
                <div class="form-group">
                  <p><strong>Update File: </strong><a id="viewUpdateFileLink" target="_blank">Download</a></p>
                </div>
                <div class="form-group">
                  <p><strong>Action Items:</strong> <span id="viewUpdateActions"></span></p>
                </div>
            </div>
          </div>
        </div>
        

        <div id="editContactModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Edit Contact</h2>
              <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
              <form id="editContactForm" action="/edit_contact" method="POST">
                <input type="hidden" name="customer_id" id="customerIdInput">
                <input type="hidden" id="editContactId" name="contact_id">
                
                <label>Name:</label>
                <input type="text" id="editContactName" name="contact_name" required>
                
                <label>Phone:</label>
                <input type="text" id="editContactPhone" name="contact_phone" required>
                
                <label>Email:</label>
                <input type="email" id="editContactEmail" name="contact_email" required>
                
                <label>Role:</label>
                <input type="text" id="editContactRole" name="contact_role" required>
                
                <button type="submit" class="btn primary">Save Changes</button>
            </form>
          </div>
        </div>
        </div>

           

        

    <script>
      function confirmDelete(event) {
        // Show a confirmation dialog
        const confirmation = confirm("Are you sure you want to delete this item?");
        
        // If the user cancels the deletion, prevent the form submission
        if (!confirmation) {
            event.preventDefault();
            return false;  // Prevent form submission
        }
        
        // If the user confirms, allow form submission to proceed
        return true;
    }

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("open");
  }

    </script>
    <script src="{{ url_for('static', filename='index.js') }}" defer></script>
  </body>
</html>